---
  - name: "Update Packages"
    yum:
      name: '*'
      state: latest

  - name: "Install Required Packages"
    yum:
      name: '{{ packages }}'
    vars:
      packages:
          - wget
          - vim
          - net-tools
          - rsync
          - epel-release
      state: installed

  - name: "Download Sensu Go Agent Repository"
    get_url:
      url: https://packagecloud.io/install/repositories/sensu/stable/script.rpm.sh
      dest: /root/

  - name: "Add Sensu Go Agent Repositroy"
    shell: bash /root/script.rpm.sh
  
  - name: "Install Sensu Go Agent Package"
    yum:
      name: sensu-go-agent
      state: latest

  - name: "Create Senus Home Directory"
    file:
      path: /home/sensu
      state: directory
      mode: '0755'

  - name: "Change Sesnu User shell and Home Directory"
    user:
      name: sensu
      shell: /bin/bash
      groups: sensu
      home: /home/sensu
      #
      #  - name: "Change Ownership"
      #    file:
      #      path: /home/sensu
      #      owner: sensu
      #      group: sensu
      #      mode: '0755'
      #
      #  - name: "Add User To SUDO Without Password"
      #    lineinfile:
      #    path: /etc/sudoers
      #    regexp: '^sensu'
      #    line: 'sensu ALL=(ALL) NOPASSWD: ALL'
      #    validate: 'visudo -cf %s'
